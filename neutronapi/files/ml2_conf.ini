{%- if salt['config.get']('neutron:mechanism:ovs')  %}
[ml2]
type_drivers = flat,vlan,gre,vxlan
tenant_network_types = vxlan
mechanism_drivers = openvswitch
{%- if salt['config.get']('neutron:controller')  %}
[ml2_type_flat]
flat_networks = external
{%- endif %}
[ml2_type_gre]
tunnel_id_ranges = 1:1000
[ml2_type_vxlan]
vni_ranges = 1:1000
[securitygroup]
enable_security_group = True
enable_ipset = True
firewall_driver = neutron.agent.linux.iptables_firewall.OVSHybridIptablesFirewallDriver
[ovs]
local_ip = {{salt['grains.get']('ip4_interfaces:eth2:0')}}
{%- if salt['config.get']('neutron:controller')  %}
bridge_mappings = external:br-ex
{%- endif %}
[agent]
veth_mtu = 1450
tunnel_types = gre
{%- else %}
[ml2]
type_drivers = flat,vxlan
tenant_network_types = vxlan
mechanism_drivers = linuxbridge,l2population
extension_drivers = port_security
[ml2_type_flat]
flat_networks = public
[ml2_type_vxlan]
vni_ranges = 1:1000
[securitygroup]
enable_ipset = True
{%- endif %}
